import{b as _e,_ as ye,a as he}from"./BillingDetails-71e8e074.js";import{r as C,z as Y,j as _,A as H,B as W,E as J,G as te,e as g,H as Q,i as I,I as ne,J as ke,K as P,O as xe,L as $e,M as F,N as Re,y as M,P as Se,Q as we,R as Ce,S as Ve,T as Pe,F as U,U as E,V as K,W as Z,X as B,Y as ee,Z as Oe,_ as Ee,f as D,$ as A,o as b,b as V,w,a as v,c as O,q as re,a0 as X,g as T,a1 as N,d as k,x as se,t as G,a2 as L,m as ae,u as Te,l as oe,D as Ge,k as j,n as ie,a3 as ue}from"./index-aee75141.js";import{_ as Ie,C as de,p as le,S as Ne}from"./CardForm-5ad2b621.js";import{b as Le,a as De,_ as je}from"./Tooltip.vue_vue_type_script_setup_true_lang-602230f1.js";import{_ as Be,a as Ae,b as Fe,c as Me,d as Ue}from"./ListView-f81a1206.js";let pe=Symbol("LabelContext");function ce(){let l=I(pe,null);if(l===null){let d=new Error("You used a <Label /> component, but it is not inside a parent.");throw Error.captureStackTrace&&Error.captureStackTrace(d,ce),d}return l}function me({slot:l={},name:d="Label",props:m={}}={}){let f=C([]);function h(p){return f.value.push(p),()=>{let s=f.value.indexOf(p);s!==-1&&f.value.splice(s,1)}}return Y(pe,{register:h,slot:l,name:d,props:m}),_(()=>f.value.length>0?f.value.join(" "):void 0)}let qe=H({name:"Label",props:{as:{type:[Object,String],default:"label"},passive:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(l,{slots:d,attrs:m}){var f;let h=(f=l.id)!=null?f:`headlessui-label-${W()}`,p=ce();return J(()=>te(p.register(h))),()=>{let{name:s="Label",slot:n={},props:o={}}=p,{passive:x,...r}=l,c={...Object.entries(o).reduce(($,[y,S])=>Object.assign($,{[y]:g(S)}),{}),id:h};return x&&(delete c.onClick,delete c.htmlFor,delete r.onClick),Q({ourProps:c,theirProps:r,slot:n,attrs:m,slots:d,name:s})}}});function ze(l,d){return l===d}let fe=Symbol("RadioGroupContext");function ve(l){let d=I(fe,null);if(d===null){let m=new Error(`<${l} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(m,ve),m}return d}let Ke=H({name:"RadioGroup",emits:{"update:modelValue":l=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>ze},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},id:{type:String,default:null}},inheritAttrs:!1,setup(l,{emit:d,attrs:m,slots:f,expose:h}){var p;let s=(p=l.id)!=null?p:`headlessui-radiogroup-${W()}`,n=C(null),o=C([]),x=me({name:"RadioGroupLabel"}),r=ne({name:"RadioGroupDescription"});h({el:n,$el:n});let[c,$]=ke(_(()=>l.modelValue),e=>d("update:modelValue",e),_(()=>l.defaultValue)),y={options:o,value:c,disabled:_(()=>l.disabled),firstOption:_(()=>o.value.find(e=>!e.propsRef.disabled)),containsCheckedOption:_(()=>o.value.some(e=>y.compare(P(e.propsRef.value),P(l.modelValue)))),compare(e,a){if(typeof l.by=="string"){let t=l.by;return(e==null?void 0:e[t])===(a==null?void 0:a[t])}return l.by(e,a)},change(e){var a;if(l.disabled||y.compare(P(c.value),P(e)))return!1;let t=(a=o.value.find(u=>y.compare(P(u.propsRef.value),P(e))))==null?void 0:a.propsRef;return t!=null&&t.disabled?!1:($(e),!0)},registerOption(e){o.value.push(e),o.value=xe(o.value,a=>a.element)},unregisterOption(e){let a=o.value.findIndex(t=>t.id===e);a!==-1&&o.value.splice(a,1)}};Y(fe,y),$e({container:_(()=>F(n)),accept(e){return e.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(e){e.setAttribute("role","none")}});function S(e){if(!n.value||!n.value.contains(e.target))return;let a=o.value.filter(t=>t.propsRef.disabled===!1).map(t=>t.element);switch(e.key){case E.Enter:Oe(e.currentTarget);break;case E.ArrowLeft:case E.ArrowUp:if(e.preventDefault(),e.stopPropagation(),Z(a,B.Previous|B.WrapAround)===ee.Success){let t=o.value.find(u=>{var i;return u.element===((i=K(n))==null?void 0:i.activeElement)});t&&y.change(t.propsRef.value)}break;case E.ArrowRight:case E.ArrowDown:if(e.preventDefault(),e.stopPropagation(),Z(a,B.Next|B.WrapAround)===ee.Success){let t=o.value.find(u=>{var i;return u.element===((i=K(u.element))==null?void 0:i.activeElement)});t&&y.change(t.propsRef.value)}break;case E.Space:{e.preventDefault(),e.stopPropagation();let t=o.value.find(u=>{var i;return u.element===((i=K(u.element))==null?void 0:i.activeElement)});t&&y.change(t.propsRef.value)}break}}let R=_(()=>{var e;return(e=F(n))==null?void 0:e.closest("form")});return J(()=>{Re([R],()=>{if(!R.value||l.defaultValue===void 0)return;function e(){y.change(l.defaultValue)}return R.value.addEventListener("reset",e),()=>{var a;(a=R.value)==null||a.removeEventListener("reset",e)}},{immediate:!0})}),()=>{let{disabled:e,name:a,form:t,...u}=l,i={ref:n,id:s,role:"radiogroup","aria-labelledby":x.value,"aria-describedby":r.value,onKeydown:S};return M(U,[...a!=null&&c.value!=null?Se({[a]:c.value}).map(([q,z])=>M(we,Ce({features:Ve.Hidden,key:q,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:t,disabled:e,name:q,value:z}))):[],Q({ourProps:i,theirProps:{...m,...Pe(u,["modelValue","defaultValue","by"])},slot:{},attrs:m,slots:f,name:"RadioGroup"})])}}});var Ye=(l=>(l[l.Empty=1]="Empty",l[l.Active=2]="Active",l))(Ye||{});let He=H({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(l,{attrs:d,slots:m,expose:f}){var h;let p=(h=l.id)!=null?h:`headlessui-radiogroup-option-${W()}`,s=ve("RadioGroupOption"),n=me({name:"RadioGroupLabel"}),o=ne({name:"RadioGroupDescription"}),x=C(null),r=_(()=>({value:l.value,disabled:l.disabled})),c=C(1);f({el:x,$el:x});let $=_(()=>F(x));J(()=>s.registerOption({id:p,element:$,propsRef:r})),te(()=>s.unregisterOption(p));let y=_(()=>{var i;return((i=s.firstOption.value)==null?void 0:i.id)===p}),S=_(()=>s.disabled.value||l.disabled),R=_(()=>s.compare(P(s.value.value),P(l.value))),e=_(()=>S.value?-1:R.value||!s.containsCheckedOption.value&&y.value?0:-1);function a(){var i;s.change(l.value)&&(c.value|=2,(i=F(x))==null||i.focus())}function t(){c.value|=2}function u(){c.value&=-3}return()=>{let{value:i,disabled:q,...z}=l,be={checked:R.value,disabled:S.value,active:!!(c.value&2)},ge={id:p,ref:x,role:"radio","aria-checked":R.value?"true":"false","aria-labelledby":n.value,"aria-describedby":o.value,"aria-disabled":S.value?!0:void 0,tabIndex:e.value,onClick:S.value?void 0:a,onFocus:S.value?void 0:t,onBlur:S.value?void 0:u};return Q({ourProps:ge,theirProps:z,slot:be,attrs:d,slots:m,name:"RadioGroupOption"})}}}),We=qe;const Je={name:"TabButtons",props:{buttons:{type:Array,required:!0},modelValue:{type:[String,Boolean,Number]}},emits:["update:modelValue"],components:{FeatherIcon:D,RadioGroup:Ke,RadioGroupOption:He,RadioGroupLabel:We},computed:{value:{get(){return this.modelValue},set(l){this.$emit("update:modelValue",l)}}}},Qe={class:"flex space-x-1 rounded bg-gray-100 p-0.5 text-sm"};function Xe(l,d,m,f,h,p){const s=A("FeatherIcon"),n=A("RadioGroupLabel"),o=A("RadioGroupOption"),x=A("RadioGroup");return b(),V(x,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=r=>p.value=r)},{default:w(()=>[v("div",Qe,[(b(!0),O(U,null,re(m.buttons,r=>(b(),V(o,{as:"template",key:r.label,value:r.value??r.label},{default:w(({active:c,checked:$})=>[v("button",{class:X([c?"ring-gray-300 focus-visible:ring":"",$?"bg-white text-gray-900 shadow":"text-gray-700","flex flex-1 justify-center gap-2 whitespace-nowrap rounded-[7px] px-3 py-[5px] leading-none transition-colors focus:outline-none"])},[r.icon?(b(),V(s,{key:0,class:"h-4 w-4",name:r.icon,label:r.label,"aria-label":r.label},null,8,["name","label","aria-label"])):T("",!0),N(k(n,{as:"span",class:"flex h-4 items-center"},{default:w(()=>[se(G(r.label),1)]),_:2},1536),[[L,r.label&&!r.hideLabel]])],2)]),_:2},1032,["value"]))),128))])]),_:1},8,["modelValue"])}const Ze=Ee(Je,[["render",Xe]]),ea={class:"bg-white px-4 pb-6 pt-5 sm:px-6"},aa={class:"flex items-center justify-between"},la={class:"flex flex-col w-full"},ta={class:"flex justify-between items-center"},na={class:"inline-flex items-center gap-1.5 text-base text-gray-800"},ra={class:"text-2xl font-semibold leading-6 text-gray-900"},sa={class:"text-sm text-gray-800 mb-7.5"},oa={class:"flex gap-1.5 mt-2"},ia={__name:"UpgradePlanStepsModal",props:ae({defaultStep:{type:Number,default:1},plan:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:ae(["success"],["update:modelValue"]),setup(l,{emit:d}){const m=l,f=d,h=I("currentSiteInfo"),p=I("plans"),s=Te(l,"modelValue"),n=C(m.defaultStep),o=_(()=>n.value===1?"Billing Details":"Payment mode"),x=C(null),r=C("Card"),c=[{label:"Card",value:"Card",description:"Your card will be charged for monthly subscription"},{label:"Prepaid credits",value:"Prepaid Credits",description:"You will be charged from your credit balance for monthly subscription"}];function $(){s.value=!1,j({url:"frappe.integrations.frappe_providers.frappecloud_billing.api",params:{method:"billing.change_payment_mode",data:{mode:r.value}},auto:!0,onSuccess:()=>y()})}function y(){ie({title:"Change plan",component:ue(M(de,{price:m.plan.price,currency:m.plan.currency})),actions:[{label:"Change plan",variant:"solid",onClick:R=>S(R)}]})}function S(R){j({url:"frappe.integrations.frappe_providers.frappecloud_billing.api",params:{method:"site.change_plan",data:{plan:m.plan.name}},auto:!0,onSuccess:()=>{h.reload(),p.reload(),R(),f("success")}})}return(R,e)=>(b(),V(g(Ge),{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value=a)},{"body-main":w(()=>[v("div",ea,[v("div",aa,[v("div",la,[v("div",ta,[v("div",na,[n.value>1?(b(),O("div",{key:0,class:"-ml-0.5 cursor-pointer",onClick:e[0]||(e[0]=a=>n.value=n.value-1)},[k(g(D),{class:"h-4.5",name:"chevron-left"})])):T("",!0),v("span",null,"Step "+G(n.value)+"/2",1)]),k(g(oe),{variant:"ghost",onClick:e[1]||(e[1]=a=>s.value=!1)},{icon:w(()=>[k(g(D),{name:"x",class:"h-4 w-4"})]),_:1})]),v("h3",ra,G(o.value||"Untitled"),1),v("div",{class:X(["my-5 h-px w-full",[n.value===1?"bg-[linear-gradient(to_right,black_0%,black_50%,#ededed_50%,#ededed_100%)]":"bg-[linear-gradient(to_right,#ededed_0%,#ededed_50%,black_50%,black_100%)]"]])},null,2)])]),N(v("div",null,[k(_e,{ref_key:"billingRef",ref:x,onSuccess:e[2]||(e[2]=()=>n.value=n.value+1)},null,512)],512),[[L,n.value===1]]),N(v("div",null,[v("div",sa,[e[5]||(e[5]=v("div",{class:"mb-1.5"},"Payment mode",-1)),k(g(Ze),{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value=a),buttons:c},null,8,["modelValue"]),v("div",oa,[k(g(D),{class:"h-4",name:"info"}),se(" "+G(c.find(a=>a.value==r.value).description),1)])]),N(k(Ie,{onSuccess:$},null,512),[[L,r.value=="Card"]]),N(k(ye,{onSuccess:$},null,512),[[L,r.value=="Prepaid Credits"]])],512),[[L,n.value===2]])])]),_:1},8,["modelValue"]))}},ua={class:"flex h-10.5 border-b items-center justify-between py-2 px-5 shrink-0"},da={class:"flex flex-col overflow-hidden px-60 pt-6"},pa={key:2,class:"text-base text-gray-900 font-semibold"},ca={key:0,class:""},ma={key:1},fa={key:1,class:"flex flex-1 items-center justify-center"},ha={__name:"Plans",emits:["success"],setup(l,{emit:d}){const m=d,f=I("team"),h=I("currentSiteInfo"),p=j({url:"frappe.integrations.frappe_providers.frappecloud_billing.api",params:{method:"billing.get_information"},cache:"billingDetails",auto:!0}),s=j({url:"frappe.integrations.frappe_providers.frappecloud_billing.api",params:{method:"site.get_plans"},cache:"plans",auto:!0}),n=_(()=>{var e;return h.data?((e=h.data.plan)==null?void 0:e.name)||"Trial":null}),o=_(()=>f.data&&f.data.currency||"INR"),x=[{label:"",key:"info",width:"8px"},{label:"Cost",key:"price",width:.8},{label:"CPU",key:"cpu",width:1.2},{label:"Memory",key:"memory",width:1.2},{label:"Disk",key:"disk",width:.7},{label:"",key:"upgrade",width:.8,align:"right"}],r=_(()=>{if(!n.value)return[];if(!s.data)return[];let e=s.data.findIndex(a=>a.name===n.value);return s.data.map((a,t)=>{let u=a.cpu_time_per_day>1?"compute hrs/day":"compute hr/day",i=o.value==="INR"?a.price_inr:a.price_usd;return{name:a.name,price:{label:i.toString(),currency:o.value==="INR"?"₹":"$"},cpu:`${a.cpu_time_per_day} ${u}`,memory:`${le(a.max_database_usage)} Database`,disk:`${le(a.max_storage_usage)} Disk`,info:a,isCurrent:a.name===n.value,isTrial:a.is_trial_plan,downgradable:a.allow_downgrading_from_other_plan,downgrade:e>t,onClick:()=>S(a,i.toString())}}).filter(a=>!a.isTrial||a.isTrial&&a.name===n.value)}),c=C(1),$=C(!1),y=C({name:"",price:"",currency:""});function S(e,a){var t;if(!((t=p.data)!=null&&t.country)||!f.data.payment_mode){c.value=p.data.country?2:1,$.value=!0,y.value={name:e.name,price:a,currency:o.value==="INR"?"₹":"$"};return}ie({title:"Change plan",component:ue(M(de,{price:a,currency:o.value==="INR"?"₹":"$"})),actions:[{label:"Change plan",variant:"solid",onClick:u=>R(e.name,u)}]})}function R(e,a){j({url:"frappe.integrations.frappe_providers.frappecloud_billing.api",params:{method:"site.change_plan",data:{plan:e}},auto:!0,onSuccess:()=>{h.reload(),s.reload(),a()}})}return Y("plans",s),(e,a)=>(b(),O(U,null,[v("header",ua,[k(g(Le),{items:[{label:"Plans"}]})]),v("div",da,[r.value.length?(b(),V(g(Fe),{key:0,columns:x,rows:r.value,"row-key":"name",options:{selectable:!1,showTooltip:!1}},{default:w(()=>[k(g(Be)),k(g(Ae),null,{default:w(()=>[(b(!0),O(U,null,re(r.value,t=>(b(),V(g(Me),{key:t.name,row:t,class:X({"bg-gray-50 rounded":t.isCurrent})},{default:w(({column:u,item:i})=>[k(g(Ue),{item:i,align:u.align},{default:w(()=>[u.key=="upgrade"&&t.isCurrent?(b(),V(g(De),{key:0,class:"shrink-0 bg-white",label:"Current plan",variant:"outline",size:"lg"})):u.key=="upgrade"&&!t.isCurrent?(b(),V(g(oe),{key:1,label:t.downgrade?"Downgrade":"Upgrade",onClick:t.onClick,disabled:!t.downgradable&&t.downgrade},null,8,["label","onClick","disabled"])):T("",!0),u.key=="price"?(b(),O("div",pa,[t.isTrial?(b(),O("span",ca," Free trial ")):(b(),O("span",ma,[v("span",null,G(i.currency)+" "+G(i.label),1),a[2]||(a[2]=v("span",{class:"text-gray-700 font-normal"},"/mo",-1))]))])):T("",!0),u.key=="info"?(b(),V(g(je),{key:3},{body:w(()=>[k(he,{plan:i},null,8,["plan"])]),default:w(()=>[k(g(D),{class:"h-4 cursor-pointer",name:"info"})]),_:2},1024)):T("",!0)]),_:2},1032,["item","align"])]),_:2},1032,["row","class"]))),128))]),_:1})]),_:1},8,["rows"])):(b(),O("div",fa,[k(g(Ne),{class:"size-8"})])),$.value?(b(),V(ia,{key:2,modelValue:$.value,"onUpdate:modelValue":a[0]||(a[0]=t=>$.value=t),defaultStep:c.value,plan:y.value,onSuccess:a[1]||(a[1]=()=>m("success"))},null,8,["modelValue","defaultStep","plan"])):T("",!0)])],64))}};export{ha as default};
//# sourceMappingURL=Plans-9b44f50a.js.map
