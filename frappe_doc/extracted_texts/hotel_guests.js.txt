// Copyright (c) 2024, Jokoor and contributors
// For license information, please see license.txt

frappe.ui.form.on("Hotel Guests", {
  refresh: function(frm) {
    // if form is not new
    if (frm.doc.__islocal != 1) {
      // call the backend api call customer billing which return the food an dstay billng and set it to the field
      frappe.call({
        method: "jokoor_hotel.api.get_customer_billing",
        args: {
          guest_id: frm.doc.name
        },
        callback: function(r) {
          if (r.message) {
          //   return {
          //     "food": food,
          //     "stay": stay,
          //     "service": service,
          //     "laundry": laundry
      
          // } this is the return data
            frm.set_value("stay_charges", r.message.stay);
            frm.set_value("food_charges", r.message.food);
            frm.set_value("service_charges", r.message.service);
            frm.set_value("laundry_charges", r.message.laundry);

            // save the form
            
            // refresh the field
            frm.refresh_field("stay_charges");
            frm.refresh_field("food_charges");
            frm.refresh_field("service_charges");
            frm.refresh_field("laundry_charges");

          }
          frm.save();

        }
      });
  }
  },
    guest_name: function(frm) {
      frm.set_value("guest_name", frm.doc.guest_name.toUpperCase());
    },
      //   frm.doc.contact_no = undefined;
      //   frm.refresh_field("contact_no");
      //   frappe.msgprint("Please enter Mobile No in the correct format");
      // } else {
      //   if (frm.doc.contact_no[0] != "9") {
      //     frm.doc.contact_no = undefined;
      //     frm.refresh_field("contact_no");
      //     frappe.msgprint("Please enter Mobile No in the correct format");
      //   }
      //   if (frm.doc.contact_no[1] != "2") {
      //     frm.doc.contact_no = undefined;
      //     frm.refresh_field("contact_no");
      //     frappe.msgprint("Please enter Mobile No in the correct format");
      //   }
      // }
   
  });
  