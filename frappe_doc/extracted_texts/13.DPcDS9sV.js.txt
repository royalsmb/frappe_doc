import{g as P,l as ie}from"../chunks/localStore.svelte.CLi1O892.js";import{r as z}from"../chunks/index.De_1-CT6.js";import{a as v,n as Q,t as _,c as ce}from"../chunks/disclose-version.BIyVqMZ8.js";import{p as R,c as h,r as m,e as j,t as de,a as X,i as L,l as N,f as W,g as e,s as A,M as S,d as C}from"../chunks/runtime.DQwr1dzu.js";import{i as ue}from"../chunks/if.D6id4Gaz.js";import{S as pe,e as B,i as E}from"../chunks/StepHeader.C3-XYovO.js";import{p as q,a as g}from"../chunks/props.BJuUnkrR.js";import{g as fe}from"../chunks/entry.BDn221P8.js";import{D as me,T as ve,M as ge,A as G}from"../chunks/afternoon.DeyIn_xk.js";import{a as he,t as J,C as K}from"../chunks/Container.CbVs3Ov9.js";import{S as be}from"../chunks/StickyBtn.C9PZ6Sn1.js";import{d as Ce,s as xe}from"../chunks/render.CzK0qdHo.js";import{f as _e}from"../chunks/fetcher.ASb0Z7gL.js";import{f as we}from"../chunks/utils.B-A_uK2n.js";const ye=async()=>{var r;const l=P("booking");if(!((r=l==null?void 0:l.court_location)!=null&&r.name))throw z(300,"/buy/play-now");const t=P("dateOptions"),{morning:s=[],afternoon:d=[],evening:o=[]}=P("timeSlots")||{};if(!(l!=null&&l.date)||!(t!=null&&t.length))throw z(300,"/buy/play-now/date-time");return{dateOptions:t||[],morning:s,afternoon:d,evening:o}},Xe=Object.freeze(Object.defineProperty({__proto__:null,load:ye},Symbol.toStringTag,{value:"Module"}));var Me=Q('<svg width="29" height="29" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.642 4.05174L11.6421 4.05174C9.57145 4.05406 7.89388 5.73162 7.89159 7.80221V13.8196C7.88872 14.8146 8.28407 15.7693 8.9897 16.4715L11.7176 19.1994C12.0709 19.5504 12.2689 20.0281 12.2672 20.5259L12.2672 26.1508C12.2672 26.4961 12.5469 26.7758 12.8922 26.7758L15.3921 26.7758C15.7374 26.7758 16.0171 26.4961 16.0171 26.1508L16.0165 20.5253C16.0154 20.0281 16.2128 19.5498 16.5655 19.1994L19.2934 16.4715C19.999 15.7694 20.3943 14.8146 20.3915 13.8196L20.3915 7.8022C20.3904 5.73159 18.7126 4.05403 16.642 4.05174ZM14.7671 25.5256L13.5172 25.5256L13.5172 23.6507L14.7671 23.6507L14.7671 25.5256ZM14.7683 22.3997L13.516 22.3997L13.5172 21.1497L14.766 21.1497L14.7683 22.3997ZM19.1421 7.80059L19.1427 13.8197C19.1444 14.4833 18.8809 15.1198 18.4107 15.5876L15.6828 18.3155C15.2483 18.7477 14.9513 19.299 14.8299 19.9004L13.4556 19.9004C13.3342 19.299 13.0373 18.7477 12.6028 18.3155L9.87373 15.5876C9.40355 15.1197 9.13997 14.4833 9.1417 13.8197L9.1417 7.80235C9.14342 6.42174 10.2616 5.3036 11.6423 5.30179L16.6422 5.30179C18.0228 5.30351 19.1409 6.42165 19.1428 7.80234L19.1421 7.80059ZM11.6418 10.3022C11.6418 11.6834 12.7611 12.8027 14.1423 12.8027C15.5236 12.8028 16.6428 11.6834 16.6429 10.3022C16.643 8.92093 15.5236 7.8017 14.1429 7.80221C12.7623 7.80394 11.6442 8.92207 11.6418 10.3022ZM15.3927 10.3022C15.3927 10.9928 14.8333 11.5522 14.1427 11.5522C13.4521 11.5522 12.8927 10.9928 12.8927 10.3022C12.8927 9.61158 13.4521 9.05221 14.1427 9.05221C14.8322 9.05338 15.3909 9.61217 15.3927 10.3022Z" fill="#321D1D"></path></svg>');function Le(l){var t=Me();v(l,t)}var Se=(l,t,s)=>{var d;t(s.court.court_number),(d=s.onSelect)==null||d.call(s,s.court.court_number)},De=_('<button><span class="flex flex-col gap-[1px]"><span class="h-3 w-6 bg-[#50ACED] font-medium text-[9.5px] flex items-center text-white justify-center"> </span> <span class="h-3 w-6 bg-[#50ACED]"></span></span> <span class="h-full w-6 bg-[#A6E08C]"></span> <span class="flex flex-col gap-[1px]"><span class="h-3 w-6 bg-[#50ACED]"></span> <span class="h-3 w-6 bg-[#50ACED]"></span></span> <span class="absolute inset-0 flex w-full justify-center"><span class="flex w-max"><svg width="2" height="32" viewBox="0 0 2 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.05645 31.2793H0.378906V0.261564H1.05645V31.2793Z" fill="white"></path></svg> <svg width="2" height="27" viewBox="0 0 2 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.01927 26.8809H0.0585938V0.543079H1.01624L1.01927 26.8809Z" fill="#82BD64"></path></svg></span></span></button>');function Te(l,t){R(t,!0);let s=q(t,"selected",15),d=q(t,"disabled",3,!1);var o=De();o.__click=[Se,s,t];var r=h(o),w=h(r),y=h(w);m(w),j(2),m(r),j(6),m(o),de(()=>{o.disabled=d(),he(o,`relative flex w-max gap-[1px] p-[2px] ${(s()===t.court.court_number?"ring-[2px] ring-secondary rounded-[2px]":"")??""}`),J(o,"opacity-40",d()),J(o,"cursor-not-allowed",d()),xe(y,t.court.court_number)}),v(l,o),X()}Ce(["click"]);var Ae=Q('<svg aria-hidden="true" class="inline w-20 h-20 text-secondary/10 animate-spin fill-secondary" fill="none" viewBox="0 0 100 101" xmlns="http://www.w3.org/2000/svg"><path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"></path><path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"></path></svg>');function Oe(l){var t=Ae();v(l,t)}var Ze=_('<h4 class="mb-4 flex items-center justify-center gap-1 text-base font-bold"><!> Court</h4>'),ke=_('<div class="flex flex-col gap-5"><div class="scrollbar-sm scrollbar flex h-[73.54px] gap-5 overflow-x-auto pb-2"></div> <div class="scrollbar-sm scrollbar flex h-[33.81px] gap-5 overflow-x-auto pb-2"></div></div>'),He=_('<div class="col-span-full grid place-items-center"><!></div>'),Pe=_('<div class="grid grid-cols-2 gap-5 rounded-xl bg-white p-5"><!></div>'),Be=_('<div class="flex flex-col gap-[40px]"><!> <!> <!></div> <!>',1);function Ye(l,t){R(t,!0);let s=ie("booking",{}),d=L(0),o=L(g(s.value.date||"")),r=L(g(s.value.timeSchedules||[])),w=L(g([])),y=L(!1);const Y=i=>{var a;const b=((a=i.find(c=>!c.disabled))==null?void 0:a.time)||"";for(const c of e(r)){const u=i.find(n=>n.time===c);(!u||u.disabled)&&C(r,g(e(r).filter(n=>n!==c)))}e(r).length||e(r).push(b)},$=()=>{s.value.court_number=e(d),s.value.date=e(o),s.value.timeSchedules=e(r),console.log("nextStep:booking.value.court_number",s.value.court_number),fe("/buy/play-now/choose-players")},ee=i=>[{title:"Morning",options:t.data.morning||[],icon:ge,bg:"#C6E5BA"},{title:"Afternoon",options:t.data.afternoon||[],icon:G,bg:"#FEF092"},{title:"Evening",options:t.data.evening||[],icon:G,bg:"#F9C4C4"}].map(({title:a,options:c,icon:u,bg:n})=>{const f=c.map(p=>{if(we(new Date,"yyyy-MM-dd")==i){const x=new Date().getHours(),Z=new Date().getMinutes(),k=x*1e3+Z,D=p.includes("PM"),M=p.replace(" AM","").replace(" PM",""),ne=M.startsWith("12"),H=parseInt(M.split(":")[0]);let T=H+12*Number(D);ne&&(T=D?12:0);const le=parseInt(M.split(":")[1]);return T*1e3+le<k?{time:p,_scheduleHour:H,scheduleHour:T,scheduleStr:M,scheduleIsPM:D,disabled:!0}:{time:p,_scheduleHour:H,scheduleHour:T,scheduleStr:M,scheduleIsPM:D,disabled:!1}}return{time:p,disabled:!1}});return{title:a,icon:u,bg:n,options:f}}),te=async i=>{var a;C(y,!0);const{data:b=[]}=await _e("/api/method/dinks.api.get_available_courts",{method:"POST",body:{date:e(o),time_schedules:i,location:((a=s.value.court_location)==null?void 0:a.name)||""}});C(w,g(b)),C(y,!1)};let ae=S(()=>ee(e(o))),F=S(()=>e(ae).map(i=>i.options).flat());N(()=>{Y(e(F))}),N(()=>{te(e(r))});var V=Be(),O=W(V),I=h(O);pe(I,{backUrl:"/buy/play-now/date-time",headerText:"any court you prefer?",children:(i,b)=>{var a=Ze(),c=h(a);Le(c),j(),m(a),v(i,a)},$$slots:{default:!0}});var U=A(I,2);K(U,{children:(i,b)=>{var a=ke(),c=h(a);B(c,21,()=>t.data.dateOptions,E,(n,f)=>{me(n,{get dateOption(){return e(f)},get selected(){return e(o)},set selected(p){C(o,g(p))}})}),m(c);var u=A(c,2);B(u,21,()=>e(F),E,(n,f)=>{var p=S(()=>({time:e(f).time}));ve(n,{get schedule(){return e(p)},get disabled(){return e(f).disabled},get selecteds(){return e(r)},set selecteds(x){C(r,g(x))}})}),m(u),m(a),v(i,a)},$$slots:{default:!0}});var se=A(U,2);K(se,{children:(i,b)=>{var a=Pe(),c=h(a);ue(c,()=>e(y),u=>{var n=He(),f=h(n);Oe(f),m(n),v(u,n)},u=>{var n=ce(),f=W(n);B(f,17,()=>e(w),E,(p,x)=>{var Z=S(()=>e(x).status==="Booked");Te(p,{get court(){return e(x)},get disabled(){return e(Z)},get selected(){return e(d)},set selected(k){C(d,g(k))}})}),v(u,n)}),m(a),v(i,a)},$$slots:{default:!0}}),m(O);var oe=A(O,2),re=S(()=>e(r).length<2||!e(d));be(oe,{action:$,btnText:"Continue",get disabled(){return e(re)}}),v(l,V),X()}export{Ye as component,Xe as universal};
